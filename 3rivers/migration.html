<!DOCTYPE html>
<html lang="en">
<head>
	<title>migrations</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	<meta name="description" content="blue atlas ::: migrations" />
	<meta name="author" content="kathy mctavish sheila packa">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/manifest.json">
	<script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "WebPage",
			"name": "migrations",
			"breadcrumb": "mctavish.io > blue atlas > migrations",
          		"url": "https://www.mctavish.io/blueatlas/migration.html",
			"description": "blueatlas ::: migrations",
			"datePublished": "2021-02-03",
          		"image": "https://www.mctavish.io/apple-touch-icon.png",
			"author": "https://mctavish.io/bio.html",
			"license": "http://creativecommons.org/licenses/by-nc-sa/3.0/us/deed.en_US"
		}
	</script>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-0989MECNZV"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-0989MECNZV');
	</script>
	<link rel="stylesheet" href="../css/fieldnotes.css"/>
	<style>
		html {
			font-family: 'Trebuchet MS', Tahoma, Verdana, Helvetica, Arial, Tahoma, 'Trebuchet MS', sans-serif;
			font-family: var(--sans);
		}
		article h1 {
			font-family: Helvetica, Arial, Tahoma, 'Trebuchet MS', sans-serif;
			font-family: var(--sans);
			font-size: 1.4em;
		}
		main ul.stanza li {
			font-weight: normal;
		}
		main article:nth-child(odd) a:before {
			color: #fcfbe3;
			color: var(--warmwhite);
			content: ": ";
		}
		main article:nth-child(even) a:before {
			color: #000000;
			color: var(--warmblack);
			content: ": ";
		}
		a {
			text-decoration: none;
		}
		a:hover {
			background-color: #7B8DA6;
		}
		main a:before {
			color: #fcfbe3;
			color: var(--warmgray);
			content: ". ";
		}
		main a:after {
			color: #fcfbe3;
			color: var(--warmwhite);
			content: " .";
		}
		main {
			max-width: 900px;
		}
		video {
			object-fit: cover;
			width: 100vw;
			height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
		}

	</style>
</head>
<body id="top" >
<div id="videoframe" class="frame zlowest">
	<video playsinline autoplay muted loop id="video1">
	  <!-- <source src="https://storage.googleapis.com/www.blueboatfilms.com/film/walkingstark.mp4" type="video/mp4"> -->
	  <source src="https://storage.cloud.google.com/www.blueboatfilms.com/film/bluewalking202011.mov" type="video/mp4">
	</video>
</div>
<div id="svgframe" class="frame zlow"><svg xmlns="http://www.w3.org/2000/svg" id="svg" class="frame"></svg></div>
<div id="wordframe" class="frame z0"></div>
<div id="subtextframe" class="frame z0"></div>
<div id="contentframe" class="absolute zhighest">
<div id="mainflex">
<main id="main" class="expand" data-state="expanded">	
<header>
	<h1>migrations</h1>
	<h2>sheila packa</h2>
</header>
<!-- <ul data-role="narrator" class="info compress">
	<li class="title typewriter" title="telegraph" id="telegraph"></li>
	<li class="title  typewriter" title="clock" id="clock">here | now</li>
</ul> -->
<ul data-role="narrator" class="info expand">
	<li><a href="#" id="soundlink" class="corelink">turn on sound</a> <span class="typewriter small" title="telegraph" id="telegraph"></span></li>
	<li><a href="index.html" id="homelink" class="corelink">return home</a></li>
</ul>
<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1><!--dream-->
	</header>
	<div class="textContent">
		<ul class="stanza">
			<li>two wild swans</li>
			<li>came in the dark hours</li>
			<li>by star light far into the journey</li>
			<li>to lend their wings</li>
			</ul>
			<ul class="stanza">
			<li>traveled north over ten rivers</li>
			<li>flew over moss riven</li>
			<li>boulders broken from the mother stone</li>
		</ul>
		<ul class="stanza">
			<li>over the fens</li>
			<li>and spears of birch</li>
			<li>through the wordless</li>
			<li>winds and migrations</li>
			<li>flew over graves</li>
			<li>and lovers reaching blindly</li>
			<li>through sheets of northern lights</li>
		</ul>
		<ul class="stanza">
			<li>two swans with feathers of falling snow</li>
		</ul>
	</div>
</article>
<article class="poem" >
	<header>
	<h1><a href="#top">^</a> </h1> <!--twelve tone geese-->
	</header>
	<div class="textContent">
		<ul class="stanza">
			<li>in synchrony and angles</li>
			<li>&nbsp;across forests</li>
			<li>&nbsp;&nbsp;over rivers</li>
			<li>&nbsp;&nbsp;&nbsp;below Venus or</li>
			<li>&nbsp;&nbsp;&nbsp;&nbsp;clouds invisible borders</li>
			<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrying nothing</li>
			<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;besides star memories</li>
			<li>&nbsp;&nbsp;&nbsp;&nbsp;along arteries of the body</li>
			<li>&nbsp;&nbsp;&nbsp;into dark interiors</li>
			<li>&nbsp;&nbsp;through the moon's phases</li>
			<li>&nbsp;calling to each other</li>
			<li>on lovers' endless roads</li>
		</ul>
	</div>
</article>
<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1> <!--north and south-->
	</header>
	<div class="textContent">
		<ul class="stanza">
			<li>if you answer</li>
			<li>when you hear their call</li>
		</ul>
		<ul class="stanza">
			<li>geese in loose and shifting lines</li>
			<li>from land to sea to cloud</li>
		</ul>
		<ul class="stanza">
			<li>cross the evening sun red</li>
			<li>on clouds of plum</li>
			<li>and rivers inlaid in gold and flowing</li>
			<li>upon the slopes</li>
		</ul>
		<ul class="stanza">
			<li>cross a border</li>
			<li>if you need to leave</li>
		</ul>
		<ul class="stanza">
			<li>in every country</li>
			<li>we are born to the same body</li>
		</ul>
		<ul class="stanza">
			<li>wind inimitable</li>
			<li>invisible forces change us</li>
			<li>beyond reach</li>
		</ul>
		<ul class="stanza">
			<li>if you make the sky your home</li>
		</ul>
		<ul class="stanza">
			<li>—it isn't easy, you can't bring</li>
			<li>those things—</li>
		</ul>
		<ul class="stanza">
			<li>wrap in those lines</li>
			<li>cross with them</li>
		</ul>
	</div>
</article>
<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1><!--a journey yes-->
	</header>
	<div class="textContent">
		<ul class="stanza">
			<li>wind turns the body</li>
			<li>and ground falls away</li>
		</ul>
		<ul class="stanza">
			<li>geese unafraid of silence</li>
			<li>or empty sky</li>
			<li>must go must go must go</li>
		</ul>
		<ul class="stanza">
			<li>reach into the wind</li>
			<li>move as clouds rimmed with sunlight</li>
			<li>or dark cloud of rain</li>
		</ul>
		<ul class="stanza">
			<li>need to follow their flight</li>
			<li>like ice in the spring</li>
			<li>that once held the river</li>
		</ul>
		<ul class="stanza">
			<li>light surges in the veins</li>
			<li>searches for the beginning</li>
			<li>of a journey yes</li>
		</ul>
		<ul class="stanza">
			<li>music you haven't heard</li>
			<li>didn't know you needed</li>
			<li>opens deep</li>
		</ul>
	</div>
</article>
<audio loop=true id="audio1" src="https://storage.googleapis.com/www.blueboatfilms.com/sound/IVdfd.mp3" type="audio/mpeg">Your browser does not support the audio tag.</audio>

</main>
</div>
</div>
<div id="hidetext"><a id="hidetextlink" href="#" title="hide text">-</a></div>
</body>
<script src="../code/velocity.min.js"></script>
<script src="../code/kefir201911.min.js"></script>
<!-- <script src="code/atlasabsence.js"></script> -->
<script>
let width = window.innerWidth, height = window.innerHeight;
let min = Math.min(width, height), max = Math.max(width, height);
let version = (min < 680 || max < 980) ? "small" : "large";
let v = version === "small" ? 0 : 1;
let z = {};
z.tools = {
	randominteger: (min, max) => {
		return Math.floor( min + Math.random()*(max-min));
	},
	logmsg: function(msg) {
		try { 
			console.log("### ::: " + msg); 
		}
		catch(err) { z.tools.logerror(err) }
	},
	logerror: function(error) {
		try { console.log("rusty error ... " + error); }
		catch(err) {}
	},
	randomhighharmonic: () => {
		let multipliers = [10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ];
	},
	randomharmonic: () => {
		let multipliers = [5, 7.5, 10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ];
	},
	randomlowharmonic: () => {
		let multipliers = [5, 7.5, 10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ]/2;
	},
	randomkey: (object) => {
		let keys = Object.keys(object);
		let key = keys[z.tools.randominteger(0,keys.length)];
		// z.tools.logmsg("key = " + key);
		return key;
	},
	datestr: (date, options) => {
		if(options===undefined) options = {year: "numeric", month: "2-digit", day: "numeric", hour12: true, hour: "2-digit", minute: "2-digit", second: "2-digit"};
		return date.toLocaleTimeString("en-US", options);
		//new Date().toLocaleTimeString("en-US", {year: "numeric", month: "2-digit", day: "numeric", hour12: true, hour: "2-digit", minute: "2-digit", second: "2-digit"});
	},
	togrid: (min=1, max=1, x=1, ndivisions=1) => {
		let dx = Math.floor( (max-min) / ndivisions );
		return Math.floor( ( x-min+dx/2)/dx )*dx + min;
	},
};
//core elements
z.elements = ( () => {
	return {
		body: { el: document.querySelector("body") },
		main: { el: document.querySelector("main") },
		// clock: { el: document.querySelector("#clock") },
		// telegraph: { el: document.querySelector("#telegraph") },
		svg:  { el: document.querySelector("#svg") },
		frames: ["subtextframe", "svgframe", "wordframe", "contentframe"].reduce( (acc, id) => {
			z.tools.logmsg("create frame element ::: " + id);
			acc[id] = { el: document.querySelector("#"+id) };
			return acc;
		}, {}),
	}
})()
	
z.streams = {
	clock: ( () => {
	let dt = 1;
	let date0 = new Date();
	let t0 = Math.floor(date0.getTime()/1000);
	let state0 = { dt: dt, count: 0, date: date0, t: t0, t0: t0 };
	return Kefir.withInterval( dt*1000, emitter => { emitter.emit( { date: new Date() } ) })
			.scan( (state, e) => { 
				state.date = e.date;
				state.t = Math.floor(e.date.getTime()/1000);
				state.count = state.count + 1;
				return state;
			}, state0  )
	})( ),
	dimensions: ( () => {
		let dt = .4;
		const ngrids=[2,2], npasts=[0,0];
		let state0 = { dt: dt, count: 0,
			grid: { nrows: ngrids[v], ncols: ngrids[v], dx: Math.floor(width/ngrids[v]), dy: Math.floor(height/ngrids[v]), sw: 12, pastn: npasts[v] },
			width: width, height: height, 
			max: max, min: min, 
		};
		return Kefir.fromEvents(window, "resize").throttle(dt*1000)
			.scan( (state,e) => {
				state.width = window.innerWidth;
				state.height = window.innerHeight;
				state.max = Math.max(state.width, state.height);
				state.min = Math.min(state.width, state.height);
				state.grid.dx = Math.floor(state.width/state.grid.ncols);
				state.grid.dy = Math.floor(state.height/state.grid.nrows);
				state.grid.sw = Math.floor(Math.max(state.grid.dx*.03, state.grid.dy*.03, 4));
				return state
			}, state0) 
	})( ),
};

z.draw = z => {

let ntimings = 32;
let dtiming = Math.floor(400/ntimings);
const timings = [...Array(ntimings).keys()].reduce( (acc, j) => {
	let duration = 500+(j*dtiming);
	acc[j] = [duration, 900-duration];
return acc;
}, []);

//controls
( () => { 
	const soundlink = document.querySelector("#soundlink");
	const hidetextlink = document.querySelector("#hidetextlink");
	const telegraph = document.querySelector("#telegraph");
	const audio1 = document.querySelector("#audio1");
	const baseurl = "https://storage.googleapis.com/www.blueboatfilms.com/sound/";
	const tracks = [
		{title: "rain clouds", url: "dronespace7.mp3", duration:360}, //6:03
		{title: "nyx ::: track #3", url: "nyx3.mp3", duration:200}, //3:20
		{title: "cistern #5", url: "cistern20140630_5_cistern.mp3", duration:1790}, //29:51
		{title: "echo & lightning", url: "echolightningpodcast.mp3", duration:2050}, //34:12
	];
	let currenttrack = 0;
	let soundplaying = false;
	let texthidden = false;
	Kefir.fromEvents(soundlink, "click").onValue( e => {
		z.tools.logmsg("play sound !");
		if(!soundplaying) { 
			try {
				currenttrack = (currenttrack+1)%tracks.length;
				let track = tracks[currenttrack];
				audio1.src = baseurl + track.url;
				// let starttime = z.tools.randominteger(0,track.duration);
				let starttime = 0;
				audio1.currentTime = starttime;
				audio1.play();
				z.tools.logmsg("playback resumed");
				telegraph.innerHTML =  "<i>(currently playing ::: " + track.title + ")</i>";
				soundplaying = true;
				soundlink.innerText = "turn off sound";
				soundlink.classList.add("active");
			} catch(e) { z.tools.logerror("dashboard ::: resumeaudio " + e) } 
		}
		else { 
			try {
				document.querySelector("#audio1").pause();
				telegraph.innerHTML =  " . . . >";
				soundplaying = false;
				soundlink.innerText = "turn on sound";
				soundlink.classList.remove("active");
			} catch(e) { z.tools.logerror("dashboard ::: suspendaudio " + e) }
		}
	});
	Kefir.fromEvents(hidetextlink, "click").onValue( e => {
		if(texthidden) {
			z.elements["main"].el.style["opacity"] = 1.0;
			hidetextlink.innerText = "-";
			hidetextlink.title = "hide text";
			texthidden = false;
		}
		else {
			z.elements["main"].el.style["opacity"] = 0.0;
			hidetextlink.innerText = "+";
			hidetextlink.title = "show text";
			texthidden = true;
		}
	});
})();

const playlist = [
	//walking film
	["#262626", "#7B8DA6", "#4D688C", "#A4ADBF", "#D7D7D9", "#556C8B", "#828EA6", "#7A889D", "#B4B4BD", "#A8B0C1", "#405F83", "#BCC1D2", "#3E597E", "#080C11", "#1C1C1C", "#557299", "#D7D6DB", "#FDFCEB"], //blues
	//birdland
	["#163341", "#172F47", "#4477A8", "#2A4A69", "#52779B", "#000000", "#384B60", "#1F3350", "#153A69", "#153559", "#9D9990", "#9D9990", "#181E21", "#0C1D32", "#706959", "#D6D3CE", "#534E48", "#3E5766", "#222E34", "#BBB4A4", "#7C7D7F"], //birdland

];
z.streams["color"] = ( dt => {
	let date0 = new Date();
	let t0 = Math.floor(date0.getTime()/1000);
	let state0 = { 
		dt: dt, count: 0,
		choices: playlist[ Math.floor(t0/dt)%playlist.length ]
	};
	return z.streams["clock"].filter( e => e.t%dt===0 )
		.scan( (state, e) => { 
			state.choices = playlist[ Math.floor(e.t/dt)%playlist.length ];
			// state.choices = playlist[ Math.floor(state.count)%playlist.length ];
			state.count = state.count + 1;
			return state;
		}, state0  )
})( 38 );

z.streams["draw"] = Kefir.combine([z.streams["clock"]], [z.streams["dimensions"], z.streams["color"]], (clock, dimensions, color) => { return {clock:clock, dimensions:dimensions, color:color} })
	.scan( (state, e) => { 
		state.clock = e.clock;
		state.dimensions = e.dimensions;
		state.color = e.color;
		state.count = state.count + 1;
		z.tools.logmsg("color.choices = " + e.color.choices);
		return state;
}, {clock:{t:0}, dt:1}  );

//main
( dt => {
	const element = document.querySelector("main");
	const bgcolors = ["rgba(25, 25, 24, 0.4)", "rgba(25, 25, 24, 0.6)", "rgba(25, 25, 24, 0.9)", "rgba(252, 251, 227, 0.4)", "rgba(252, 251, 227, 0.9)", , "rgba(252, 251, 227, 0.6)"]
	// const warmblacktints = ["#191918", "#2f2f2f", "#464646", "#5e5e5d", "#757574", "#8c8c8b", "#a3a3a2", "#babab9", "#d1d1d0", "#e8e8e7", "#ffffff", "#fcfbe3", "#e2e1cc", "#c9c8b5", "#b0af9e", "#979688", "#7e7d71", "#64645a", "#4b4b44", "#32322d", "#191916", "#000000"];
	const warmblacktints = ["#191918", "#fcfbe3", "#000000"];
	const blues = ["#262626", "#7B8DA6", "#4D688C", "#556C8B", "#828EA6", "#7A889D",  "#405F83", "#3E597E", "#080C11", "#1C1C1C", "#557299"];
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		try {
			let count = e.clock.t/dt;
			// let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
			// z.tools.logmsg("in BOX " + color + " color =  " + color);
			let color = blues[z.tools.randominteger(0, blues.length)];
			Velocity({	
				elements: element, 
				properties: { backgroundColor:  color, backgroundColorAlpha: z.tools.randominteger(2,8)/10},
				options: { duration: 1200,  delay: 0, easing: "easeInOutQuad" },
			});
		} catch(err) { z.tools.logerror("box animation ::: " + err ) }
	})
})(9);

//lines
( dt => {
	let nshapes = [2,4][v];
	let width = window.innerWidth, height = window.innerHeight;
	const elements = [...Array(nshapes).keys()].reduce( (acc, j) => {
		// z.tools.logmsg("create line element ::: " + id);
		let el = document.createElementNS("http://www.w3.org/2000/svg", "line");
		el.setAttributeNS(null, "id", "line_"+ j);
		el.setAttributeNS(null, "class", "shape line");
		el.setAttributeNS(null, "stroke-width", width);
		el.setAttributeNS(null, "stroke-opacity", 0.01);
		// el.setAttributeNS(null, "stroke-dasharray", z.tools.randominteger(height/2,height));
		el.setAttributeNS(null, "x1", width/2);
		el.setAttributeNS(null, "x2", width/2);
		el.setAttributeNS(null, "y1", 0);
		el.setAttributeNS(null, "y2", height);

		z.elements["svg"].el.appendChild(el);
		acc[j] = { el: el };
	return acc;
	}, []);

	const drawings = [
		e => {
			try {
				let count = e.clock.t/dt;
				let width = e.dimensions.width, height = e.dimensions.height;
				let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
				Velocity({	
					elements: elements[count%nshapes].el,
					properties: { strokeOpacity: z.tools.randominteger(1,8)/10, stroke: color, strokeWidth: z.tools.randominteger(0,e.dimensions.height*2), strokeDasharray: z.tools.randominteger(18, e.dimensions.min/2), x1: 0, x2: e.dimensions.width, y1: e.dimensions.height, y2: e.dimensions.height },
					options: { duration: z.tools.randominteger(1000*dt*nshapes/3,1000*dt*nshapes), delay: 0 },
				});
			} catch(err) { z.tools.logerror("circle animation 1 ::: " + err ) }
		},
		
	];
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		drawings[0](e);
	})
})(1);

//circles0
( dt => {
	let nshapes = [2,4][v];
	let width = window.innerWidth, height = window.innerHeight;
	let colors = ["#163341", "#172F47", "#4477A8", "#2A4A69", "#52779B", "#000000", "#384B60", "#1F3350", "#153A69", "#153559", "#9D9990", "#9D9990", "#181E21", "#0C1D32", "#706959", "#D6D3CE", "#534E48", "#3E5766", "#222E34", "#BBB4A4", "#7C7D7F"]; //birdland
	const elements = [...Array(nshapes).keys()].reduce( (acc, j) => {
		let el = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		el.setAttributeNS(null, "id", "circle0_"+ j);
		el.setAttributeNS(null, "class", "shape circle");
		el.setAttributeNS(null, "cy", 0);
		el.setAttributeNS(null, "cx", width/2);
		z.elements["svg"].el.appendChild(el);
		acc[j] = { el: el };
	return acc;
	}, []);

	const drawings = [
		e => {
			try {
				let count = e.clock.t/dt;
				let r = z.tools.randominteger(e.dimensions.min/10, e.dimensions.min);
				let color = colors[z.tools.randominteger(0, colors.length)];
				Velocity({	
					elements: elements[count%nshapes].el,
					properties: { fillOpacity: z.tools.randominteger(1,8)/10, strokeOpacity: 0.0, fill: color, stroke: color, strokeWidth: z.tools.randominteger(1,8)/10*r, strokeDasharray: z.tools.randominteger(8, r), cx: e.dimensions.width/2, cy: 0, r: r },
					options: { duration: z.tools.randominteger(1000*dt*nshapes/3,1000*dt*nshapes), delay: 0 },
				});
			} catch(err) { z.tools.logerror("circle animation 1 ::: " + err ) }
		},
		
	];
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		drawings[0](e);
	})
})(2);

};


window.addEventListener('load', e => {
  z.draw(z);
  window.scroll(0,0);
  // window.setTimeout(() => { document.querySelector("#contentframe").style.opacity = 1.0 }, 1800);
});
window.addEventListener('beforeunload', e => {
	window.scroll(0,0);
});
</script>
</html>